<html>
<head>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>

<script>
    var options = {
        "key": "{{ your_razorpay_key }}",  // Replace with your Razorpay key
        "amount": {{ amount }} * 100,
        "currency": "INR",
        "name": "AQUA MOTUS",
        "description": "Ticket Booking",
        "order_id": "{{ order_id }}",  // Pass the order ID generated by Razorpay
        "handler": function(response) {
            $.ajax({
                type: "POST",
                url: "{% url 'WebUser:payment_success' %}",
                data: {
                    razorpay_payment_id: response.razorpay_payment_id,
                    razorpay_order_id: response.razorpay_order_id,
                    razorpay_signature: response.razorpay_signature,
                    booking_id: "{{ booking_id }}",  // Pass the booking ID to the server
                    csrfmiddlewaretoken: '{{ csrf_token }}'
                },
                success: function(result) {
                    if (result.success) {
                        window.location.href = "{% url 'WebUser:ViewTicketBooking' %}";
                    } else {
                        alert(result.error);  // Display error if payment failed
                    }
                }
            });
        },
        "theme": {
            "color": "#3399cc"
        }
    };

    $(document).ready(function() {
        var rzp1 = new Razorpay(options);
        rzp1.open();
    });
</script>

</body>
</html>
